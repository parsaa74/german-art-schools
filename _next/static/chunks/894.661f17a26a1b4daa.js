"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[894],{8214:function(e,t,n){n.r(t),n.d(t,{default:function(){return Background}});var r=n(7437),a=n(2265),o=n(6375),i=n(5362);function Background(){let e=(0,a.useRef)(null),{size:t}=(0,i.D)(),n=(0,a.useMemo)(()=>({time:{value:0},resolution:{value:new o.Vector2(t.width*window.devicePixelRatio,t.height*window.devicePixelRatio)}}),[t]);return(0,a.useEffect)(()=>{n.resolution.value.set(t.width*window.devicePixelRatio,t.height*window.devicePixelRatio)},[t,n]),(0,i.F)(t=>{let{clock:n}=t;e.current&&(e.current.uniforms.time.value=n.getElapsedTime())}),(0,r.jsxs)("mesh",{renderOrder:-1,children:[" ",(0,r.jsx)("planeGeometry",{args:[2,2]})," ",(0,r.jsx)("shaderMaterial",{ref:e,vertexShader:"\n  varying vec2 vUv;\n  void main() {\n    vUv = uv;\n    // Position the quad to fill the screen, respecting camera perspective\n    gl_Position = vec4(position.xy * 2.0, 0.0, 1.0); \n  }\n",fragmentShader:"\n  uniform float time;\n  uniform vec2 resolution;\n  varying vec2 vUv;\n\n  // Noise function (e.g., Simplex or Perlin - using a simple one here for brevity)\n  // Source: https://thebookofshaders.com/11/\n  float random (vec2 st) {\n      return fract(sin(dot(st.xy, vec2(12.9898,78.233))) * 43758.5453123);\n  }\n\n  // 2D Noise based on Morgan McGuire @morgan3d\n  // https://www.shadertoy.com/view/4dS3Wd\n  float noise (vec2 st) {\n      vec2 i = floor(st);\n      vec2 f = fract(st);\n\n      // Four corners in 2D of a tile\n      float a = random(i);\n      float b = random(i + vec2(1.0, 0.0));\n      float c = random(i + vec2(0.0, 1.0));\n      float d = random(i + vec2(1.0, 1.0));\n\n      // Smooth Interpolation\n      vec2 u = f*f*(3.0-2.0*f);\n      // u = smoothstep(0.,1.,f); // Alternative interpolation\n\n      // Mix 4 corners percentages\n      return mix(a, b, u.x) +\n              (c - a)* u.y * (1.0 - u.x) +\n              (d - b) * u.x * u.y;\n  }\n\n  // FBM (Fractal Brownian Motion) for more complex patterns\n  float fbm (vec2 st) {\n      float value = 0.0;\n      float amplitude = .5;\n      float frequency = 0.;\n      // Loop of octaves\n      for (int i = 0; i < 5; i++) { // Fewer octaves for performance\n          value += amplitude * noise(st);\n          st *= 2.;\n          amplitude *= .5;\n      }\n      return value;\n  }\n\n  void main() {\n    // Adjust UVs based on resolution to avoid stretching\n    vec2 uv = vUv; // Use vUv directly for screen space\n    vec2 aspectCorrectedUv = uv * vec2(resolution.x / resolution.y, 1.0);\n\n    // Evolving noise pattern\n    float noisePattern = fbm(aspectCorrectedUv * 2.5 + time * 0.05); // Slower evolution, adjust scale\n\n    // Add another layer of slower, larger noise for variation\n    float slowNoise = fbm(aspectCorrectedUv * 0.8 + time * 0.02);\n\n    // Color mapping - create a dark, ethereal look\n    vec3 color1 = vec3(0.01, 0.02, 0.05); // Deep blue/purple\n    vec3 color2 = vec3(0.05, 0.1, 0.2);  // Slightly lighter blue\n    vec3 color3 = vec3(0.1, 0.05, 0.15); // Hint of magenta/purple\n\n    // --- FIX: Define combinedNoise before use ---\n    float combinedNoise = noisePattern * 0.7 + slowNoise * 0.3; // Combine noise patterns\n\n    vec3 finalColor = mix(color1, color2, smoothstep(0.3, 0.6, combinedNoise));\n    finalColor = mix(finalColor, color3, smoothstep(0.5, 0.8, slowNoise * 0.5 + noisePattern * 0.5));\n\n    // Add subtle vignette\n    float vignette = smoothstep(0.8, 0.3, length(uv - 0.5)); // Inward vignette\n    finalColor *= vignette * 1.2; // Apply vignette and slightly boost brightness\n\n    // Add subtle grain (optional)\n    // finalColor += (random(uv + time * 0.1) - 0.5) * 0.03;\n\n    gl_FragColor = vec4(finalColor, 1.0);\n  }\n",uniforms:n,depthWrite:!1,depthTest:!1})]})}},6894:function(e,t,n){n.r(t),n.d(t,{Scene:function(){return Scene}});var r=n(7437),a=n(2265),o=n(5362),i=n(6154),l=n(6282),s=n(8811),c=n.n(s),u=n(4033),d=n(5565),p=n(5013),f=n(2777);function VisualizationToggle(){let{visualizationMode:e,setVisualizationMode:t}=(0,d.d)(),[n,o]=(0,a.useState)(!1);(0,a.useEffect)(()=>{o(!0)},[]);let toggleVisualizationMode=()=>{t("network"===e?"d3-force":"network")};return n?(0,r.jsxs)(f.E.div,{className:"fixed bottom-4 left-1/2 transform -translate-x-1/2 z-[9999] bg-black/50 backdrop-blur-md rounded-full px-1 py-1 flex items-center shadow-lg border border-blue-500/20",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:1},children:[(0,r.jsx)("button",{className:"px-4 py-2 rounded-full text-sm font-medium transition-colors ".concat("network"===e?"bg-blue-600 text-white":"bg-transparent text-gray-300 hover:text-white"),onClick:toggleVisualizationMode,children:"3D Network"}),(0,r.jsx)("button",{className:"px-4 py-2 rounded-full text-sm font-medium transition-colors ".concat("d3-force"===e?"bg-blue-600 text-white":"bg-transparent text-gray-300 hover:text-white"),onClick:toggleVisualizationMode,children:"D3 Force"})]}):null}var h=n(4660);let g=(0,h.Ue)(e=>({map:null,selectedSchool:null,nodePositions:new Map,activePanel:null,setMap:t=>e({map:t}),setSelectedSchool:t=>e({selectedSchool:t}),setNodePositions:t=>e({nodePositions:t}),setActivePanel:t=>e({activePanel:t})}));var m=n(2866),y=n(8252),v=n(6375),x=n(1513),b=n(2602),w=n(1559),S=n(3387),M=n(8609),k=n(5449),C=n(3966),A=n(928);let F={university:new v.Color("#2979FF"),art_academy:new v.Color("#5D9DFF"),design_school:new v.Color("#4D9EFF"),music_academy:new v.Color("#85B8FF"),film_school:new v.Color("#3D8BFF"),default:new v.Color("#2979FF")},E={university:new v.Color("#5D9DFF"),art_academy:new v.Color("#85B8FF"),design_school:new v.Color("#4D9EFF"),music_academy:new v.Color("#A7CBFF"),film_school:new v.Color("#3D8BFF"),default:new v.Color("#5D9DFF")};new v.Color("#FFFFFF"),new v.Color("#A7CBFF"),new v.Color("#5D9DFF");let j=(()=>{let e=new v.IcosahedronGeometry(.75,2);return e})();function NetworkGraph(e){let{universities:t,onLayoutUpdate:n,hoverNodeName:i,selectedNodeName:l,userData:s}=e;if(!t||0===t.length)return console.log("NetworkGraph: No universities data provided or empty array."),null;let c=(0,a.useRef)(null),u=(0,a.useRef)(null),d=(0,a.useRef)([]),p=(0,a.useRef)(new Map),f=(0,a.useRef)(null),h=(0,a.useRef)(null),g=(()=>{let e={};return Object.entries(F).forEach(t=>{let[n,r]=t,a=E[n];e[n]=new v.MeshStandardMaterial({color:r,emissive:a,emissiveIntensity:1.5,metalness:.9,roughness:.2,transparent:!0,opacity:1,side:v.DoubleSide})}),e})(),m=g.default,y=(0,a.useMemo)(()=>{let e=new Float32Array(3*t.length);return t.forEach((t,n)=>{let r=F[t.type]||F.default,a={h:0,s:0,l:0};r.getHSL(a);let o=new v.Color().setHSL(a.h+(.05*Math.random()-.025),a.s+(.1*Math.random()-.05),a.l);o.toArray(e,3*n)}),e},[t]),N=(0,a.useMemo)(()=>{let e=new Float32Array(t.length);return t.forEach((n,r)=>{let a=0;if(l){if(n.name===l)a=2;else{var o;let e=null===(o=t.find(e=>e.name===l))||void 0===o?void 0:o.type,r=e&&n.type===e;a=r?4:3}}else i&&n.name===i&&(a=1);e[r]=a}),e},[t,i,l]);return((0,a.useEffect)(()=>{if(c.current){if(c.current.geometry.hasAttribute("instanceColor")){let e=c.current.geometry.getAttribute("instanceColor");e.array=y,e.needsUpdate=!0}else c.current.geometry.setAttribute("instanceColor",new v.InstancedBufferAttribute(y,3));if(c.current.geometry.hasAttribute("instanceState")){let e=c.current.geometry.getAttribute("instanceState");e.array=N,e.needsUpdate=!0}else c.current.geometry.setAttribute("instanceState",new v.InstancedBufferAttribute(N,1));f.current&&f.current.length===t.length?t.forEach((e,t)=>{if(h.current){let e=N[t],n=1.5;switch(Math.floor(e)){case 2:n=2.7;break;case 1:n=1.5*1.4;break;case 4:n=1.8900000000000001;break;case 3:n=1.0499999999999998;break;default:n=1.5}h.current[t]=n}}):(f.current=new Float32Array(t.length).fill(1.5),h.current=new Float32Array(t.length).fill(1.5),console.log("Initialized scale refs for",t.length,"universities.")),console.log("Updated instance attributes:",c.current.geometry.hasAttribute("instanceColor"),c.current.geometry.hasAttribute("instanceState"))}},[y,N,t]),(0,o.F)((e,n)=>{if(c.current&&f.current&&h.current){c.current.visible||(c.current.visible=!0,console.log("Made mesh visible"));let a=e.clock.getElapsedTime();for(let e=0;e<c.current.count;e++){var r;let o=new v.Matrix4,i=new v.Vector3,l=new v.Quaternion,s=new v.Vector3;c.current.getMatrixAt(e,o),o.decompose(i,l,s);let u=null===(r=Array.from(p.current.entries()).find(e=>{let[t,n]=e;return .01>n.distanceToSquared(i)}))||void 0===r?void 0:r[0],d=u?t.find(e=>e.name===u):null,g=(null==d?void 0:d.type)||"default",m=0,y=0,x=0,b=0,w=N[e],S=w<3,M=S?1:.3;switch(g){case"university":m=.15*Math.sin(.4*a+.2*e)*M,i.x+=.03*Math.cos(.3*a+.1*e)*M,i.z+=.03*Math.sin(.2*a+.1*e)*M,y=.03*Math.sin(.2*a+.1*e)*M,x=.03*Math.cos(.3*a+.1*e)*M;break;case"art_academy":m=.12*Math.sin(.5*a+.2*e)*M,i.x+=.05*Math.cos(.3*a+.2*e)*M,i.z+=.04*Math.sin(.25*a+.15*e)*M,y=.05*Math.sin(.4*a+.1*e)*M,x=.05*Math.cos(.3*a+.1*e)*M,b=.02*Math.sin(.2*a+.1*e)*M;break;case"design_school":m=.1*Math.sin(.6*a+.3*e)*M,i.x+=.04*Math.cos(.4*a+.2*e)*M,i.z+=.04*Math.sin(.4*a+.2*e)*M,y=.04*Math.sin(.5*a+.2*e)*M,x=.04*Math.cos(.4*a+.2*e)*M;break;case"music_academy":m=.14*Math.sin(.7*a+.1*e)*M,i.x+=.03*Math.cos(.6*a+.1*e)*M,i.z+=.03*Math.sin(.5*a+.2*e)*M,y=.04*Math.sin(.6*a+.3*e)*M,x=.04*Math.cos(.5*a+.2*e)*M,b=.03*Math.sin(.4*a+.1*e)*M;break;case"film_school":m=.13*Math.sin(.4*a+.2*e)*M,i.x+=.06*Math.cos(.3*a+.1*e)*M,i.z+=.05*Math.sin(.35*a+.15*e)*M,y=.05*Math.sin(.3*a+.2*e)*M,x=.05*Math.cos(.25*a+.15*e)*M,b=.02*Math.sin(.2*a+.1*e)*M;break;default:m=.08*Math.sin(.3*a+.1*e)*M,i.x+=.02*Math.cos(.2*a+.1*e)*M,i.z+=.02*Math.sin(.25*a+.15*e)*M,y=.02*Math.sin(.2*a+.1*e)*M,x=.02*Math.cos(.2*a+.1*e)*M}i.y+=m,l.setFromEuler(new v.Euler(y,x,b));let k=1.5;switch(Math.floor(w)){case 2:k=2.7*(1+.12*Math.sin(2.5*a));break;case 1:k=1.5*1.4*(1+.07*Math.sin(3.5*a));break;case 4:k=1.8900000000000001*(1+.05*Math.sin(1.8*a+.2*e));break;case 3:k=1.0499999999999998*(1+.01*Math.sin(.6*a+e));break;default:k=1.5*(1+.03*Math.sin(1*a+.3*e))}h.current[e]=k;let C=Math.min(8*n,1);f.current[e]=v.MathUtils.lerp(f.current[e],h.current[e],C);let A=f.current[e];s.setScalar(A),o.compose(i,l,s),c.current.setMatrixAt(e,o)}c.current.instanceMatrix.needsUpdate=!0}}),(0,a.useEffect)(()=>{console.log("NetworkGraph: Initializing simulation for InstancedMesh."),d.current=t.map(e=>{var t;return{id:e.name,type:e.type,programCount:(null===(t=e.programTypes)||void 0===t?void 0:t.length)||0,originalData:e}});let e=x.Z(d.current,3).force("link",b.Z().id(e=>e.id).strength(.02).distance(3)).force("charge",w.Z().strength(-30)).force("center",S.Z(0,0,0).strength(.2)).force("collision",M.Z().radius(1).strength(.6)).force("x",k.Z().strength(.05)).force("y",C.Z().strength(.05)).force("z",A.Z().strength(.05)).alphaDecay(.01).stop();return u.current=e,e.on("tick",()=>{var e;if(!c.current)return;c.current.visible||(c.current.visible=!0);let r=(null===(e=u.current)||void 0===e?void 0:e.nodes())||[],a=new Map,o=!1,i=1/0,l=-1/0,s=1/0,d=-1/0,f=1/0,h=-1/0;c.current&&c.current.count!==t.length&&(c.current.count=t.length),r.forEach((e,t)=>{var n,r,u;let g=null!==(n=e.x)&&void 0!==n?n:0,m=null!==(r=e.y)&&void 0!==r?r:0,y=null!==(u=e.z)&&void 0!==u?u:0,x=new v.Matrix4;c.current.getMatrixAt(t,x);let b=new v.Vector3,w=new v.Quaternion,S=new v.Vector3;x.decompose(b,w,S),b.set(g,m,y),x.compose(b,w,S),t<c.current.count&&c.current.setMatrixAt(t,x);let M=new v.Vector3(g,m,y),k=p.current.get(e.id);(!k||k.distanceToSquared(M)>1e-4)&&(o=!0),a.set(e.id,M),void 0!==e.x&&(i=Math.min(i,e.x),l=Math.max(l,e.x)),void 0!==e.y&&(s=Math.min(s,e.y),d=Math.max(d,e.y)),void 0!==e.z&&(f=Math.min(f,e.z),h=Math.max(h,e.z))}),c.current.instanceMatrix.needsUpdate=!0,(o||a.size!==p.current.size)&&(p.current=a,n(a)),u.current&&.01>u.current.alpha()&&u.current.stop()}),console.log("NetworkGraph: Starting simulation heating."),e.alpha(1).restart(),()=>{console.log("NetworkGraph: Stopping simulation and cleaning up."),u.current&&(u.current.stop(),u.current.on("tick",null)),u.current=null,d.current=[],p.current.clear()}},[t,n]),0===t.length)?null:(console.log("Rendering InstancedMesh with ".concat(t.length," instances.")),(0,r.jsx)("group",{name:"networkNodesGroup",children:(0,r.jsxs)("instancedMesh",{ref:c,args:[j,m,t.length],userData:{...s,accessibilityInfo:{type:"visualization",count:t.length,description:"Interactive 3D network of German art schools"}},name:"networkNodes",frustumCulled:!1,children:[(0,r.jsx)("instancedBufferAttribute",{attach:"geometry.attributes.instanceColor",args:[y,3],needsUpdate:!0}),(0,r.jsx)("instancedBufferAttribute",{attach:"geometry.attributes.instanceState",args:[N,1],needsUpdate:!0})]})}))}new v.Object3D;var N=n(8214),T=n(5963);function AnimatedLine(e){let{points:t,startColor:n="#1E90FF",endColor:i="#00FFFF",lineWidth:l=1.5,opacity:s=.7,animationDuration:c=.6}=e,u=(0,a.useRef)(null),d=(0,a.useRef)(null),p=(0,a.useRef)(0),f=(0,a.useMemo)(()=>t[0].distanceTo(t[1]),[t]),{size:h}=(0,o.D)(),g=(0,a.useMemo)(()=>new v.Vector2(h.width,h.height),[h.width,h.height]);return(0,o.F)((e,t)=>{p.current<1&&u.current&&d.current&&(p.current+=t/c,p.current=Math.min(p.current,1),d.current.dashOffset=f*(1-p.current),d.current.needsUpdate=!0)}),(0,r.jsx)(T.x,{ref:u,points:t,color:"white",lineWidth:l,transparent:!0,opacity:s,dashed:!0,dashSize:f,gapSize:f,children:(0,r.jsx)("lineMaterialImpl",{ref:d,vertexColors:!0,linewidth:l,transparent:!0,opacity:s,dashed:!0,dashSize:f,gapSize:f,dashOffset:f,resolution:g,blending:v.AdditiveBlending})})}function ConnectionLines(e){let{points:t}=e;return t&&0!==t.length?(0,r.jsx)("group",{children:t.map((e,t)=>(0,r.jsx)(AnimatedLine,{points:e},"line-".concat(t)))}):null}var D=n(5657),I=n(396);let U=new v.SphereGeometry(.3,16,16),O=new v.MeshStandardMaterial({transparent:!0,roughness:.3,metalness:.4,envMapIntensity:1.5}),P=new v.Vector3;function CustomForceGraph(e){var t;let{scale:n=1,position:i=[0,0,0]}=e,l=(0,a.useRef)(null),s=(0,a.useRef)(null),{scene:c}=(0,o.D)(),{processedUniversities:u,selectedUniversity:p,setSelectedUniversity:f}=(0,d.d)(),[h,g]=(0,a.useState)([]),[m,y]=(0,a.useState)([]),x=(0,a.useRef)([]),[b,w]=(0,a.useState)(null),[S,M]=(0,a.useState)(null),k=(0,a.useCallback)(e=>new v.Color({university:"#2979FF",art_academy:"#5D9DFF",design_school:"#4D9EFF",music_academy:"#85B8FF",film_school:"#3D8BFF"}[e]||"#2979FF"),[]),C=(0,a.useCallback)(e=>{let t=k(e);return t.clone().multiplyScalar(1.3)},[k]);(0,a.useEffect)(()=>{if(0===u.length){g([]),y([]),x.current=[];return}console.log("GraphLayout: Creating initial data structure.");let e=u.map((e,t)=>({id:e.name,name:e.name,type:e.type,state:e.state,university:e,pos:new v.Vector3((Math.random()-.5)*8,(Math.random()-.5)*8,(Math.random()-.5)*8),vel:new v.Vector3(0,0,0),currentScale:1,targetScale:1,currentOpacity:.8,targetOpacity:.8,currentColor:k(e.type),targetColor:k(e.type),currentEmissiveIntensity:.8,targetEmissiveIntensity:.8,instanceId:t})),t={};e.forEach(e=>{t[e.state]||(t[e.state]=[]),t[e.state].push(e)});let n=[];Object.values(t).forEach(e=>{if(e.length>1)for(let t=0;t<e.length;t++)for(let r=t+1;r<Math.min(e.length,t+3);r++)n.push({source:e[t].id,target:e[r].id,value:1,currentWidth:1.5,targetWidth:1.5,currentOpacity:.4,targetOpacity:.4})});let r={};e.forEach(e=>{r[e.type]||(r[e.type]=[]),r[e.type].push(e)});let a=new Set(n.map(e=>[e.source,e.target].sort().join("--")));Object.values(r).forEach(e=>{if(e.length>1)for(let t=0;t<e.length;t++)for(let r=t+1;r<Math.min(e.length,t+3);r++){let o=[e[t].id,e[r].id].sort().join("--");a.has(o)||(n.push({source:e[t].id,target:e[r].id,value:.5,currentWidth:.75,targetWidth:.75,currentOpacity:.3,targetOpacity:.3}),a.add(o))}}),g(e),y(n),x.current=e,console.log("GraphLayout: Initial data structure created.")},[u,k,C]),(0,a.useEffect)(()=>{let e=x.current;e&&(e.forEach(e=>{let t=(null==p?void 0:p.name)===e.id,n=b===e.instanceId,r=t?2.2:n?1.8:1.2,a=t?.95:n?.9:.8;(e.targetScale!==r||e.targetOpacity!==a)&&(e.targetScale=r,e.targetOpacity=a)}),m.forEach(t=>{let n=e.find(e=>e.id===t.source),r=e.find(e=>e.id===t.target);if(n&&r){let e=(null==p?void 0:p.name)===n.id,a=(null==p?void 0:p.name)===r.id,o=b===n.instanceId,i=b===r.instanceId,l=e||a||o||i,s=l?2.5*t.value:1.5*t.value,c=l?.8:.4;(t.targetWidth!==s||t.targetOpacity!==c)&&(t.targetWidth=s,t.targetOpacity=c)}else{let e=1.5*t.value;(t.targetWidth!==e||.4!==t.targetOpacity)&&(t.targetWidth=e,t.targetOpacity=.4)}}))},[b,p,m]);let A=(0,a.useMemo)(()=>new v.Object3D,[]);(0,a.useMemo)(()=>new v.Color,[]);let F=(0,a.useMemo)(()=>new Map(h.map(e=>[e.id,e])),[h]);(0,o.F)((e,t)=>{if(!l.current||!s.current||0===x.current.length)return;let n=Math.min(10*t,1),r=Math.min(t,.05),a=e.clock.getElapsedTime(),o=x.current;o.forEach(e=>{P.copy(e.pos).multiplyScalar(-.1),e.vel.addScaledVector(P,r),o.forEach(t=>{if(e.id===t.id)return;P.copy(e.pos).sub(t.pos);let n=P.lengthSq();n>.25&&n<16?e.vel.addScaledVector(P.normalize(),4/n*r):n<=.25&&n>1e-6&&e.vel.addScaledVector(P.normalize(),32*r)}),e.vel.multiplyScalar(.95),e.pos.addScaledVector(e.vel,r)});let i=!1,c=!1;o.forEach((t,r)=>{var a,o;void 0!==t.currentScale&&void 0!==t.targetScale&&(t.currentScale=v.MathUtils.lerp(t.currentScale,t.targetScale,n)),void 0!==t.currentOpacity&&void 0!==t.targetOpacity&&(t.currentOpacity=v.MathUtils.lerp(t.currentOpacity,t.targetOpacity,n));let l=e.clock.getElapsedTime(),u=.1*r;P.copy(t.pos).add(new v.Vector3(.03*Math.cos(.3*l+u),.05*Math.sin(.5*l+u),.04*Math.sin(.4*l+u)));let d=null!==(o=t.targetScale)&&void 0!==o?o:1.2,p=t.currentScale*(1+Math.sin(l*(d>1.5?1.2:d>1.3?1.1:.8)+u)*(d>1.5?.15:d>1.3?.1:.05));A.position.copy(P),A.scale.set(p,p,p),A.updateMatrix(),s.current.setMatrixAt(t.instanceId,A.matrix),i=!0,(null===(a=s.current)||void 0===a?void 0:a.instanceColor)&&(s.current.setColorAt(t.instanceId,t.currentColor),c=!0)}),i&&(s.current.instanceMatrix.needsUpdate=!0),c&&s.current.instanceColor&&(s.current.instanceColor.needsUpdate=!0),m.forEach((e,t)=>{var r,i,s,c,u;let d=o.length+t,p=null===(r=l.current)||void 0===r?void 0:r.children[d];if(!p||!p.material||!p.geometry)return;e.currentWidth=v.MathUtils.lerp(null!==(i=e.currentWidth)&&void 0!==i?i:1.5,null!==(s=e.targetWidth)&&void 0!==s?s:1.5,n),e.currentOpacity=v.MathUtils.lerp(null!==(c=e.currentOpacity)&&void 0!==c?c:.4,null!==(u=e.targetOpacity)&&void 0!==u?u:.4,n),p.material.opacity=e.currentOpacity,p.material.needsUpdate=!0;let f=F.get(e.source),h=F.get(e.target);if(f&&h){let n=new v.Vector3().addVectors(f.pos,h.pos).multiplyScalar(.5),r=new v.Vector3(0,.5*Math.sin(.5*t+.2*a),0);n.add(r);let o=new v.QuadraticBezierCurve3(f.pos,n,h.pos);try{let e=o.getPoints(10);p.geometry.setFromPoints(e),p.geometry.attributes.position.needsUpdate=!0}catch(t){console.error("Error updating link geometry:",t,e)}}})});let E=(0,a.useCallback)(e=>{if(void 0===e)return;let t=x.current.find(t=>t.instanceId===e);t&&((null==p?void 0:p.name)===t.id?(f(null),M(null)):t.university?(f(t.university),M(t.instanceId),console.log("GraphLayout: Selected university set to:",t.university.name)):console.error("GraphLayout: University data missing for node:",t.id))},[p,f]),j=(0,a.useCallback)(e=>{void 0!==e&&(w(e),document.body.style.cursor="pointer")},[]),N=(0,a.useCallback)(()=>{w(null),document.body.style.cursor="auto"},[]),z=(0,a.useMemo)(()=>{let e=null!=S?S:b;if(null===e)return null;let t=h.find(t=>t.instanceId===e);return t?{...t,pos:t.pos}:null},[S,b,h]);return 0===h.length?null:(0,r.jsxs)("group",{ref:l,position:i,scale:n,children:[(0,r.jsx)(D.EJ,{ref:s,limit:h.length,geometry:U,material:O,castShadow:!0,receiveShadow:!0,onClick:e=>{e.stopPropagation(),E(e.instanceId)},onPointerOver:e=>{e.stopPropagation(),j(e.instanceId)},onPointerOut:e=>{e.stopPropagation(),N()}}),m.map((e,t)=>{let n=F.get(e.source),a=F.get(e.target);if(!n||!a)return null;let o=n.instanceId===S||a.instanceId===S,i=n.instanceId===b||a.instanceId===b,l=[n.pos.clone(),a.pos.clone()];return(0,r.jsx)(T.x,{points:l,color:o||i?"rgba(65, 145, 255, 0.8)":"rgba(41, 121, 255, 0.4)",lineWidth:e.currentWidth,transparent:!0,opacity:e.currentOpacity,dashed:!1},"link-".concat(e.source,"-").concat(e.target,"-").concat(t))}),z&&(0,r.jsx)(I.V,{position:[z.pos.x,z.pos.y+.4*(null!==(t=z.currentScale)&&void 0!==t?t:1),z.pos.z],center:!0,distanceFactor:10,sprite:!1,transform:!0,occlude:!0,style:{pointerEvents:"none"},children:(0,r.jsx)("div",{className:"px-3 py-1.5 rounded-lg text-sm font-medium whitespace-nowrap shadow-lg transform transition-all duration-300",style:{background:"linear-gradient(135deg, rgba(18,24,33,0.95) 0%, rgba(41,121,255,0.8) 100%)",border:"1px solid rgba(65,145,255,0.6)",color:"#ffffff",textShadow:"0 1px 2px rgba(0,0,0,0.5)",boxShadow:"0 0 15px rgba(41,121,255,0.5), 0 0 30px rgba(41,121,255,0.3)"},children:z.name})})]})}var z=n(8467),R=n(8004);function PostProcessing(){let{gl:e}=(0,o.D)();return e?(0,r.jsx)(z.x,{children:(0,r.jsx)(R.d,{intensity:.4,luminanceThreshold:.9,luminanceSmoothing:.025})}):null}var V=n(2274);let L={};async function loadFontWithCache(e){if(L[e])return L[e];try{let t=await new Promise((t,n)=>{let r=new V.J;r.load(e,e=>t(e),void 0,e=>n(e))});return L[e]=t,t}catch(t){throw console.error("Error loading font from ".concat(e,":"),t),t}}function SceneEventHandler(e){let{universityMap:t,nodePositions:n,setHoverUniversityName:r,setSelectedUniversity:i,selectedUniversity:l,setConnectionLines:s,controlsEnabled:c}=e,{camera:u,raycaster:d,pointer:p,scene:f}=(0,o.D)(),h=(0,a.useRef)(null),g=(0,a.useRef)(null),checkIntersection=()=>{if(!c)return null;d.setFromCamera(p,u);let e=f.getObjectByName("networkNodes");if(e&&e instanceof v.InstancedMesh){let t=new v.Matrix4,r=new v.Vector3,a=new v.Vector3,o=new v.Quaternion,i=d.intersectObject(e,!1);if(i.length>0){let a=i[0].instanceId;if(void 0!==a&&a<e.count){for(let[o,i]of(e.getMatrixAt(a,t),r.setFromMatrixPosition(t),n.entries()))if(.01>i.distanceToSquared(r))return o}}for(let i=0;i<e.count;i++){e.getMatrixAt(i,t),r.setFromMatrixPosition(t),t.decompose(r,o,a);let l=d.ray.distanceToPoint(r),s=Math.max(a.x,a.y,a.z),c=.5*s;if(l<c){for(let[e,t]of n.entries())if(.01>t.distanceToSquared(r))return e}}}return null};(0,a.useEffect)(()=>{if(!c)return;let e=checkIntersection();if(e&&e!==h.current){if(r(e),e!==(null==l?void 0:l.name)){let e=getAudioContext();if(e){let t=e.createOscillator(),n=e.createGain();t.connect(n),n.connect(e.destination),t.frequency.setValueAtTime(1200,e.currentTime),n.gain.setValueAtTime(.05,e.currentTime),n.gain.exponentialRampToValueAtTime(.001,e.currentTime+.03),t.start(e.currentTime),t.stop(e.currentTime+.03)}}h.current=e,document.body.style.cursor="pointer"}else!e&&h.current&&(r(null),h.current=null,document.body.style.cursor="auto")},[p,c,l,r]);let handleClick=()=>{c&&(g.current&&(clearTimeout(g.current),g.current=null),g.current=setTimeout(()=>{let e=checkIntersection();handleNodeInteraction(e),g.current=null},50))},handleNodeInteraction=e=>{e?e===(null==l?void 0:l.name)?(console.log("SceneEventHandler: Deselecting node:",e),i(null),s([]),playDeselectSound()):(console.log("SceneEventHandler: Selecting node:",e),selectNode(e)):l&&(console.log("SceneEventHandler: Clicked outside, deselecting node:",l.name),i(null),s([]))},playDeselectSound=()=>{let e=getAudioContext();if(e){let t=e.createOscillator(),n=e.createGain();t.connect(n),n.connect(e.destination),t.type="square",t.frequency.setValueAtTime(330,e.currentTime),n.gain.setValueAtTime(.08,e.currentTime),n.gain.exponentialRampToValueAtTime(.001,e.currentTime+.08),t.start(e.currentTime),t.stop(e.currentTime+.08)}},selectNode=e=>{let n=t.get(e);if(n&&n.name&&n.type){console.log("SceneEventHandler: Selected university data:",n);let t={...n,name:n.name||e,type:n.type||"default",state:n.state||"Unknown",city:n.city||"Unknown",website:n.website||"#",description:n.description||"No description available",programTypes:n.programTypes||[],founded:n.founded||"Unknown",students:n.students||"Unknown"};console.log("SceneEventHandler: Setting selected university to:",t.name),setTimeout(()=>{i(t),console.log("SceneEventHandler: Selected university set to:",t.name)},10),playSelectSound()}else{console.error("SceneEventHandler: Missing or incomplete university data for:",e),console.log("SceneEventHandler: Available data:",n);let t={id:"fallback-".concat(e.replace(/\s+/g,"-").toLowerCase()),name:e,type:"default",state:"Unknown",location:[0,0],programCount:0,website:"#",programTypes:[],city:"Unknown",description:"Information for this institution is currently unavailable.",founded:"Unknown",students:"Unknown"};console.log("SceneEventHandler: Setting fallback university to:",t.name),setTimeout(()=>{i(t),console.log("SceneEventHandler: Fallback university set to:",t.name)},10),playSelectSound()}updateConnectionLines(e)},playSelectSound=()=>{let e=getAudioContext();if(e){let t=e.createOscillator(),n=e.createGain();t.connect(n),n.connect(e.destination),t.type="triangle",t.frequency.setValueAtTime(660,e.currentTime),n.gain.setValueAtTime(.1,e.currentTime),n.gain.linearRampToValueAtTime(0,e.currentTime+.054),t.start(e.currentTime),t.stop(e.currentTime+.06)}},updateConnectionLines=e=>{let t=n.get(e);if(t){let r=Array.from(n.entries()).filter(t=>{let[n,r]=t;return n!==e}).sort((e,n)=>{let[,r]=e,[,a]=n;return t.distanceTo(r)-t.distanceTo(a)}).slice(0,5).map(e=>{let[t,n]=e;return n});s(r.map(e=>[t,e]))}else s([])};return(0,a.useEffect)(()=>(window.addEventListener("click",handleClick),()=>{window.removeEventListener("click",handleClick),g.current&&clearTimeout(g.current),document.body.style.cursor="auto"}),[]),null}(0,o.e)({LineMaterialImpl:l.Y});let _=null,G=null,B=null,W=null,getAudioContext=()=>(_||(_=new(window.AudioContext||window.webkitAudioContext)),_),playAmbientSound=async()=>{let e=getAudioContext();e&&!G&&B&&((G=e.createBufferSource()).buffer=B,G.loop=!0,(W=e.createGain()).gain.value=.15,G.connect(W),W.connect(e.destination),G.start(0),console.log("Ambient sound started."))},stopAmbientSound=()=>{G&&(G.stop(),G.disconnect(),G=null,console.log("Ambient sound stopped.")),W&&(W.disconnect(),W=null)},loadAmbientSound=async e=>{let t=getAudioContext();if(t&&!B)try{console.log("Loading ambient sound...");let n=await fetch(e),r=await n.arrayBuffer();B=await t.decodeAudioData(r),console.log("Ambient sound loaded."),await playAmbientSound()}catch(e){console.error("Error loading ambient sound:",e),B=null}};function FrameInvalidator(e){let{controlsEnabled:t}=e,{invalidate:n}=(0,o.D)();return(0,a.useEffect)(()=>{t||n()},[t,n]),null}function SceneContent(e){let{invalidate:t}=(0,o.D)(),n=(0,a.useRef)(),{processedUniversities:i,universityMap:l,selectedUniversity:s,setSelectedUniversity:c,hoverUniversityName:u,setHoverUniversityName:p,connectionLines:f,setConnectionLines:h,controlsEnabled:g,nodePositions:v,setNodePositions:x,activeStateFilter:b,activeProgramFilter:w,visualizationMode:S,setVisualizationMode:M}=(0,d.d)();!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],[t,n]=(0,a.useState)({}),[r,o]=(0,a.useState)(!1),[i,l]=(0,a.useState)(null),s=JSON.stringify(e);(0,a.useEffect)(()=>{let e=JSON.parse(s);if(0===e.length){o(!0);return}let t=!0,loadAllFonts=async()=>{o(!1),l(null),n({});try{let r={};await Promise.all(e.map(async e=>{try{let n=await loadFontWithCache(e);t&&(r[e]=n)}catch(t){console.warn("Failed to load font from ".concat(e,":"),t)}})),t&&(n(r),o(!0))}catch(e){console.error("Error loading fonts:",e),t&&(l(e instanceof Error?e:Error(String(e))),o(!0))}};return loadAllFonts(),()=>{t=!1}},[s]),(0,a.useMemo)(()=>({fonts:t,loaded:r,error:i}),[t,r,i])}(),(0,a.useEffect)(()=>{let attemptAudioSetup=async()=>{let e=getAudioContext();e&&"suspended"===e.state?console.log("AudioContext suspended. Waiting for user interaction."):e?(console.log("AudioContext running. Loading sound."),await loadAmbientSound("/audio/ambient_loop.mp3")):console.log("AudioContext not available yet.")},handleClickForAudio=async()=>{console.log("User interaction detected (click). Resuming/Starting AudioContext.");let e=getAudioContext();e&&"suspended"===e.state&&(await e.resume(),console.log("AudioContext resumed.")),B?G||await playAmbientSound():await loadAmbientSound("/audio/ambient_loop.mp3")};return attemptAudioSetup(),window.addEventListener("click",handleClickForAudio,{once:!0}),()=>{stopAmbientSound(),window.removeEventListener("click",handleClickForAudio)}},[]),(0,a.useEffect)(()=>{s||h([])},[s,h]);let k=(0,a.useMemo)(()=>Array.isArray(i)?i.filter(e=>{if(!e)return!1;let t=!b||e.state===b,n=!w||Array.isArray(e.programTypes)&&e.programTypes.some(e=>e===w);return t&&n}):[],[i,b,w]);return(0,a.useEffect)(()=>{console.log("SceneContent: Filtered Universities Count:",k.length),k.length>0&&console.log("SceneContent: First filtered university:",k[0])},[k]),(0,r.jsxs)(a.Suspense,{fallback:null,children:[(0,r.jsx)(m.c,{makeDefault:!0,position:[0,0,30],fov:60}),(0,r.jsx)("ambientLight",{intensity:1}),(0,r.jsx)("pointLight",{position:[10,10,10],intensity:1}),(0,r.jsx)("pointLight",{position:[-10,-10,-10],intensity:.5,color:"#5588ff"}),(0,r.jsx)("directionalLight",{position:[0,5,5],intensity:.5}),(0,r.jsx)(N.default,{}),k.length>0?"d3-force"===S?(0,r.jsx)(CustomForceGraph,{scale:1.5,position:[0,0,0]}):(0,r.jsx)(NetworkGraph,{universities:k,onLayoutUpdate:x,hoverNodeName:u,selectedNodeName:(null==s?void 0:s.name)||null}):(0,r.jsx)(r.Fragment,{}),(0,r.jsx)(y.z,{ref:n,enablePan:!0,enableZoom:!0,enableRotate:!0,minDistance:1,maxDistance:100,enabled:g,onStart:()=>t(),onEnd:()=>t(),onChange:()=>t(),makeDefault:!0,enableDamping:!1}),(0,r.jsx)(ConnectionLines,{points:f}),i.length>0&&(0,r.jsx)(SceneEventHandler,{processedUniversities:k,universityMap:l,nodePositions:v,setHoverUniversityName:p,setSelectedUniversity:c,selectedUniversity:s,setConnectionLines:h,controlsEnabled:g,hoverUniversityName:u}),(0,r.jsx)(FrameInvalidator,{controlsEnabled:g}),(0,r.jsx)(PostProcessing,{})]})}var H=n(4710);function Scene(e){let{lang:t,dict:n}=e,o=(0,u.useParams)(),l=t||(null==o?void 0:o.lang)||"en",{selectedUniversity:s,setSelectedUniversity:c,activeStateFilter:f,setActiveStateFilter:h,activeProgramFilter:m,setActiveProgramFilter:y,uniqueStates:v,uniqueProgramTypes:x,visualizationMode:b}=(0,d.d)(),{activePanel:w,setActivePanel:S}=g(),[M,k]=(0,a.useState)(!1),C=(0,d.d)(e=>e.initializeStore);(0,a.useEffect)(()=>{k(!0),C()},[C]);let togglePanel=e=>{w===e?S(null):S(e)};return M?(0,r.jsxs)("div",{className:"fixed inset-0 w-full h-full bg-gradient-to-br from-[#101820] to-[#18212B] visualization-container",onClick:()=>{console.log("Outer div clicked - potential audio trigger point")},children:[(0,r.jsx)("a",{href:"#info-panel",className:"skip-to-content",children:"Skip to school information"}),(0,r.jsxs)("div",{className:"absolute inset-0 w-full h-full z-0",children:[" ","d3-force"===b?(0,r.jsxs)("div",{className:"w-full h-full flex items-center justify-center p-4",children:[" ",(0,r.jsx)(H.Z,{width:M?.8*window.innerWidth:800,height:M?.8*window.innerHeight:600,className:"bg-white rounded-lg shadow-lg"})]}):(0,r.jsx)(i.Xz,{gl:{antialias:!0,alpha:!0,preserveDrawingBuffer:!0,powerPreference:"high-performance"},dpr:[1,2],frameloop:"demand",className:"w-full h-full",children:(0,r.jsx)(SceneContent,{lang:l,dict:n})},b)]}),(0,r.jsx)("button",{onClick:()=>togglePanel("filter"),className:"absolute top-4 left-4 z-20 p-2 bg-white/10 backdrop-blur-sm rounded text-white hover:bg-white/20 transition-colors pointer-events-auto","aria-label":"Toggle Filters",children:"Filters"}),"filter"===w&&(0,r.jsxs)("div",{className:"absolute top-16 left-4 z-20 bg-gray-900/90 backdrop-blur-sm p-4 rounded shadow-lg text-white max-w-xs pointer-events-auto",children:[(0,r.jsx)("h3",{className:"font-bold mb-2 text-cyan-300",children:"Filter Options"}),(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("label",{htmlFor:"state-filter-scene",className:"block text-xs font-medium text-cyan-200 mb-1",children:"State"}),(0,r.jsxs)("select",{id:"state-filter-scene",value:f||"",onChange:e=>{h(e.target.value||null)},className:"w-full bg-gray-800/80 border border-cyan-700/60 text-gray-100 text-sm rounded focus:ring-cyan-500 focus:border-cyan-500 p-1.5 appearance-none custom-select",children:[(0,r.jsx)("option",{value:"",children:"All States"}),Array.isArray(v)&&v.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]}),(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("label",{htmlFor:"program-filter-scene",className:"block text-xs font-medium text-cyan-200 mb-1",children:"Program Type"}),(0,r.jsxs)("select",{id:"program-filter-scene",value:m||"",onChange:e=>{y(e.target.value||null)},className:"w-full bg-gray-800/80 border border-cyan-700/60 text-gray-100 text-sm rounded focus:ring-cyan-500 focus:border-cyan-500 p-1.5 appearance-none custom-select",children:[(0,r.jsx)("option",{value:"",children:"All Programs"}),Array.isArray(x)&&x.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]})]}),(0,r.jsx)("div",{className:"absolute bottom-4 right-4 z-20 pointer-events-auto",children:(0,r.jsx)(VisualizationToggle,{})}),s&&(0,r.jsx)(p.Z,{school:s,isOpen:!!s,onClose:()=>{console.log("handleClosePanel called, clearing selectedUniversity"),c(null)}})]}):(0,r.jsx)("div",{className:"relative h-screen w-screen bg-gradient-to-br from-[#101820] to-[#18212B] flex items-center justify-center",children:(0,r.jsx)("p",{className:"text-white text-xl",children:"Loading Scene..."})})}c()(()=>Promise.resolve().then(n.bind(n,8214)),{loadableGenerated:{webpack:()=>[8214]},ssr:!1}),(0,o.e)({LineMaterialImpl:l.Y})},4710:function(e,t,n){n.d(t,{Z:function(){return D3NetworkGraph}});var r=n(7437),a=n(2265),o=n(1709),i=n(5565);let getNodeColor=e=>{let t={university:"#5c7cfa",art_academy:"#f5a623",design_school:"#50e3c2",music_academy:"#e4717a",film_school:"#bd10e0",default:"#9b9b9b"};return t[e]||t.default},getNodeRadius=e=>Math.min(15,6+.5*e.programCount);function D3NetworkGraph(e){let{width:t=800,height:n=600,className:l=""}=e,s=(0,a.useRef)(null),c=(0,a.useRef)(null),{processedUniversities:u,selectedUniversity:d,setSelectedUniversity:p}=(0,i.d)(),[f,h]=(0,a.useState)([]),[g,m]=(0,a.useState)([]);return(0,a.useEffect)(()=>{if(!u||0===u.length){h([]),m([]);return}let e=u.map(e=>{var t;return{id:e.name,name:e.name,type:e.type,state:e.state,programCount:(null===(t=e.programTypes)||void 0===t?void 0:t.length)||0,university:e}});e.map(e=>[e.id,e]);let t=[],n=new Set,r={};u.forEach(e=>{r[e.state]||(r[e.state]=[]),r[e.state].push(e.name)}),Object.values(r).forEach(e=>{if(e.length>1)for(let r=0;r<e.length;r++)for(let a=r+1;a<e.length;a++){let o=e[r],i=e[a],l=[o,i].sort().join("--");n.has(l)||(t.push({source:o,target:i,value:1,type:"state"}),n.add(l))}});let a={};u.forEach(e=>{a[e.type]||(a[e.type]=[]),a[e.type].push(e.name)}),Object.values(a).forEach(e=>{if(e.length>1)for(let r=0;r<e.length;r++)for(let a=r+1;a<e.length;a++){let o=e[r],i=e[a],l=[o,i].sort().join("--");n.has(l)||(t.push({source:o,target:i,value:.5,type:"type"}),n.add(l))}}),h(e),m(t)},[u]),(0,a.useEffect)(()=>{var e;if(!s.current||0===f.length)return;let r=o.Ys(s.current);r.selectAll("*").remove();let a=r.append("defs"),i=a.append("radialGradient").attr("id","node-gradient").attr("cx","30%").attr("cy","30%").attr("r","70%");i.append("stop").attr("offset","0%").attr("stop-color","#ffffff").attr("stop-opacity",.7),i.append("stop").attr("offset","100%").attr("stop-color","currentColor").attr("stop-opacity",1);let l=r.append("g").attr("class","graph-content"),u=o.Ys("body").append("div").attr("class","d3-tooltip").style("position","absolute").style("visibility","hidden").style("background","rgba(0, 0, 0, 0.8)").style("color","white").style("padding","5px 10px").style("border-radius","4px").style("font-size","12px").style("pointer-events","none");c.current=o.A4v(f).force("link",o.Fsl(g).id(e=>e.id).distance(e=>80/e.value).strength(e=>.1*e.value)).force("charge",o.q5i().strength(-150).distanceMax(t/4)).force("center",o.wqt(t/2,n/2).strength(.1)).force("collision",o.Hh().radius(e=>1.5*getNodeRadius(e)+3).strength(.8)).alphaTarget(0).alphaDecay(.03);let h=l.append("g").attr("class","links").attr("stroke","#555").attr("stroke-opacity",.4).selectAll("line").data(g).join("line").attr("stroke",e=>"state"===e.type?"#777":"#555").attr("stroke-opacity",e=>"state"===e.type?.6:.4).attr("stroke-width",e=>Math.max(.5,1+.8*e.value)).attr("data-type",e=>e.type),m=l.append("g").attr("class","nodes").selectAll("g.node-container").data(f,e=>e.id).join("g").attr("class","node-container").style("cursor","pointer").call((e=c.current,o.ohM().on("start",function(t,n){t.active||e.alphaTarget(.3).restart(),n.fx=n.x,n.fy=n.y}).on("drag",function(e,t){t.fx=e.x,t.fy=e.y}).on("end",function(t,n){t.active||e.alphaTarget(0)})));m.append("circle").attr("class","node-circle").attr("r",e=>getNodeRadius(e)).attr("fill","url(#node-gradient)").style("color",e=>getNodeColor(e.type)).attr("stroke","#1a1a1a").attr("stroke-width",1.5),m.append("text").attr("class","node-label").text(e=>e.name).attr("x",0).attr("y",e=>getNodeRadius(e)+12).attr("dy","0.35em").attr("text-anchor","middle").attr("font-family","Inter, sans-serif").attr("font-size","9px").attr("fill","#ccc").style("pointer-events","none").style("opacity",.7),c.current.on("tick",()=>{h.attr("x1",e=>{var t;return null!==(t=e.source.x)&&void 0!==t?t:0}).attr("y1",e=>{var t;return null!==(t=e.source.y)&&void 0!==t?t:0}).attr("x2",e=>{var t;return null!==(t=e.target.x)&&void 0!==t?t:0}).attr("y2",e=>{var t;return null!==(t=e.target.y)&&void 0!==t?t:0}),m.attr("transform",e=>{var t,n;return"translate(".concat(null!==(t=e.x)&&void 0!==t?t:0,",").concat(null!==(n=e.y)&&void 0!==n?n:0,")")})}),m.on("click",(e,t)=>{e.stopPropagation(),p((null==d?void 0:d.name)===t.id?null:t.university)}).on("mouseover",(e,t)=>{u.style("visibility","visible").text(t.name),m.style("opacity",e=>t.id===e.id||v.has("".concat(t.id,",").concat(e.id))||v.has("".concat(e.id,",").concat(t.id))?1:.3),m.filter(e=>e.id===t.id).raise().select("circle.node-circle").transition().duration(100).attr("r",1.3*getNodeRadius(t)).attr("stroke-width",2),h.style("stroke-opacity",e=>isLinkConnected(t,e)?"state"===e.type?.7:.5:.1),h.filter(e=>isLinkConnected(t,e)).attr("stroke","#87CEFA").attr("stroke-width",e=>Math.max(1,(1+.8*e.value)*1.2)),m.filter(e=>e.id===t.id).select("text.node-label").style("opacity",1)}).on("mousemove",e=>{u.style("top",e.pageY-10+"px").style("left",e.pageX+10+"px")}).on("mouseout",()=>{u.style("visibility","hidden"),m.style("opacity",1).select("circle.node-circle").transition().duration(100).attr("r",e=>getNodeRadius(e)).attr("stroke-width",1.5),h.style("stroke-opacity",e=>"state"===e.type?.6:.4).attr("stroke",e=>"state"===e.type?"#777":"#555").attr("stroke-width",e=>Math.max(.5,1+.8*e.value)),m.select("text.node-label").attr("fill","#ccc").style("opacity",.7),updateSelectionStyle()});let y=o.sPX().scaleExtent([.2,5]).on("zoom",e=>{l.attr("transform",e.transform)});r.call(y);let v=new Map;function isLinkConnected(e,t){let n="string"==typeof t.source?t.source:t.source.id,r="string"==typeof t.target?t.target:t.target.id;return n===e.id||r===e.id}function updateSelectionStyle(){m.each(function(e){let t=(null==d?void 0:d.name)===e.id,n=o.Ys(this).select("circle.node-circle"),r=o.Ys(this).select("text.node-label");n.transition().duration(100).attr("r",t?1.5*getNodeRadius(e):getNodeRadius(e)).attr("stroke-width",t?2.5:1.5).attr("stroke",t?"#87CEFA":"#1a1a1a"),r.transition().duration(100).style("opacity",t?1:.7).attr("fill",t?"#fff":"#ccc").attr("font-weight",t?"bold":"normal")}),m.filter(e=>(null==d?void 0:d.name)===e.id).raise(),h.style("stroke-opacity",e=>{let t="string"==typeof e.source?e.source:e.source.id,n="string"==typeof e.target?e.target:e.target.id,r=d&&(t===d.name||n===d.name);return r?.8:"state"===e.type?.6:.4}).attr("stroke",e=>{let t="string"==typeof e.source?e.source:e.source.id,n="string"==typeof e.target?e.target:e.target.id,r=d&&(t===d.name||n===d.name);return r?"#87CEFA":"state"===e.type?"#777":"#555"})}return g.forEach(e=>{let t="string"==typeof e.source?e.source:e.source.id,n="string"==typeof e.target?e.target:e.target.id;v.set("".concat(t,",").concat(n),!0)}),updateSelectionStyle(),()=>{var e;null===(e=c.current)||void 0===e||e.stop(),u.remove()}},[f,g,t,n,d,p]),(0,r.jsx)("div",{className:"d3-network-graph-container ".concat(l),children:(0,r.jsx)("svg",{ref:s,width:t,height:n,style:{backgroundColor:"#18212B"}})})}}}]);